<!DOCTYPE html>
<html lang="pt-br">
<head>
<meta charset="UTF-8">
<title>Minha Rotina Semanal DinÃ¢mica</title>
<style>
  body { font-family: sans-serif; }
  table { border-collapse: collapse; width: 100%; }
  th, td { border: 1px solid #cccccc; padding: 8px; text-align: center; vertical-align: middle; transition: background-color 0.3s; }
  th { background-color: #f2f2f2; }
  .study { background-color: #e0f7fa; }
  .work { background-color: #fff9c4; }
  .exercise { background-color: #dcedc8; }
  .family { background-color: #ffe0b2; }
  .leisure { background-color: #f3e5f5; }
  .personal { background-color: #e0e0e0; }

  /* NOVOS ESTILOS PARA O DESTAQUE */
  .highlight-day {
    background-color: #dbeafe !important; /* Azul claro para o dia */
  }
  .highlight-time {
    background-color: #dcfce7 !important; /* Verde claro para a hora */
  }
  .highlight-intersect {
    background-color: #93c5fd !important; /* Azul mais forte para a cÃ©lula atual */
    font-weight: bold;
    color: black;
  }
</style>
</head>
<body>

<h2>Planilha de Rotina com Destaque de Dia e Hora Atuais</h2>
<p>Hoje Ã© <strong><span id="current-day-text"></span></strong>. A rotina estÃ¡ destacando o dia e horÃ¡rio atuais.</p>

<table id="schedule-table">
  <thead>
    <tr>
      <th>HorÃ¡rio</th>
      <th>Segunda-feira</th>
      <th>TerÃ§a-feira</th>
      <th>Quarta-feira</th>
      <th>Quinta-feira</th>
      <th>Sexta-feira</th>
      <th>SÃ¡bado</th>
      <th>Domingo</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><b>05:30 - 06:00</b></td>
      <td class="personal">ğŸ’§ Despertar & Higiene</td>
      <td class="personal">ğŸ’§ Despertar & Higiene</td>
      <td class="personal">ğŸ’§ Despertar & Higiene</td>
      <td class="personal">ğŸ’§ Despertar & Higiene</td>
      <td class="personal">ğŸ’§ Despertar & Higiene</td>
      <td class="personal">ğŸ’§ Despertar & Higiene</td>
      <td class="personal">ğŸ’§ Despertar & Higiene</td>
    </tr>
    <tr>
      <td><b>06:00 - 06:30</b></td>
      <td rowspan="3" class="study">ğŸ“š <b>ESTUDO</b> (1.5h)</td>
      <td rowspan="3" class="study">ğŸ“š <b>ESTUDO</b> (1.5h)</td>
      <td rowspan="3" class="study">ğŸ“š <b>ESTUDO</b> (1.5h)</td>
      <td rowspan="3" class="study">ğŸ“š <b>ESTUDO</b> (1.5h)</td>
      <td rowspan="3" class="study">ğŸ“š <b>ESTUDO</b> (1.5h)</td>
      <td rowspan="4" class="study">ğŸ“š <b>ESTUDO</b> (2h)</td>
      <td rowspan="4" class="study">ğŸ“š <b>ESTUDO</b> (2h)</td>
    </tr>
    <tr>
      <td><b>06:30 - 07:00</b></td>
    </tr>
    <tr>
      <td><b>07:00 - 07:30</b></td>
    </tr>
    <tr>
      <td><b>07:30 - 08:00</b></td>
      <td class="family">ğŸ‘¨â€ğŸ‘§ Rotina ManhÃ£ + ğŸš— Deslocamento</td>
      <td class="family">ğŸ‘¨â€ğŸ‘§ Rotina ManhÃ£ (CafÃ©)</td>
      <td class="family">ğŸ‘¨â€ğŸ‘§ Rotina ManhÃ£ + ğŸš— Deslocamento</td>
      <td class="family">ğŸ‘¨â€ğŸ‘§ Rotina ManhÃ£ (CafÃ©)</td>
      <td class="family">ğŸ‘¨â€ğŸ‘§ Rotina ManhÃ£ (CafÃ©)</td>
    </tr>
    <tr>
      <td><b>08:00 - 08:30</b></td>
      <td rowspan="7" class="work">ğŸ’¼ <b>TRABALHO</b></td>
      <td rowspan="7" class="work">ğŸ’¼ <b>TRABALHO</b></td>
      <td rowspan="7" class="work">ğŸ’¼ <b>TRABALHO</b></td>
      <td rowspan="7" class="work">ğŸ’¼ <b>TRABALHO</b></td>
      <td rowspan="7" class="work">ğŸ’¼ <b>TRABALHO</b></td>
      <td rowspan="10" class="family">ğŸ‘¨â€ğŸ‘©â€ğŸ‘§ CafÃ© da ManhÃ£ & Tempo Livre / FamÃ­lia</td>
      <td rowspan="10" class="family">ğŸ‘¨â€ğŸ‘©â€ğŸ‘§ CafÃ© da ManhÃ£ & Tempo Livre / FamÃ­lia</td>
    </tr>
    <tr><td><b>08:30 - 09:00</b></td></tr>
    <tr><td><b>09:00 - 09:30</b></td></tr>
    <tr><td><b>09:30 - 10:00</b></td></tr>
    <tr><td><b>10:00 - 10:30</b></td></tr>
    <tr><td><b>10:30 - 11:00</b></td></tr>
    <tr><td><b>11:00 - 11:30</b></td></tr>
    <tr>
      <td><b>11:30 - 12:00</b></td>
      <td rowspan="3" class="personal">ğŸ› AlmoÃ§o / Pausa</td>
      <td rowspan="2" class="exercise">ğŸ’ª <b>EXERCÃCIO</b></td>
      <td rowspan="3" class="personal">ğŸ› AlmoÃ§o / Pausa</td>
      <td rowspan="2" class="exercise">ğŸ’ª <b>EXERCÃCIO</b></td>
      <td rowspan="2" class="exercise">ğŸ’ª <b>EXERCÃCIO</b></td>
    </tr>
    <tr>
      <td><b>12:00 - 12:30</b></td>
    </tr>
    <tr>
      <td><b>12:30 - 13:00</b></td>
      <td class="exercise">ğŸ› AlmoÃ§o PÃ³s-Treino</td>
      <td class="exercise">ğŸ› AlmoÃ§o PÃ³s-Treino</td>
      <td class="exercise">ğŸ› AlmoÃ§o PÃ³s-Treino</td>
    </tr>
    <tr>
      <td><b>13:00 - 13:30</b></td>
      <td rowspan="9" class="work">ğŸ’¼ <b>TRABALHO</b></td>
      <td rowspan="9" class="work">ğŸ’¼ <b>TRABALHO</b></td>
      <td rowspan="9" class="work">ğŸ’¼ <b>TRABALHO</b></td>
      <td rowspan="9" class="work">ğŸ’¼ <b>TRABALHO</b></td>
      <td rowspan="9" class="work">ğŸ’¼ <b>TRABALHO</b></td>
      <td rowspan="7" class="family">ğŸ‘¨â€ğŸ‘©â€ğŸ‘§ Tempo Livre / FamÃ­lia</td>
      <td rowspan="7" class="family">ğŸ‘¨â€ğŸ‘©â€ğŸ‘§ Tempo Livre / FamÃ­lia</td>
    </tr>
    <tr><td><b>13:30 - 14:00</b></td></tr>
    <tr><td><b>14:00 - 14:30</b></td></tr>
    <tr>
      <td><b>14:30 - 15:00</b></td>
    </tr>
    <tr><td><b>15:00 - 15:30</b></td></tr>
    <tr><td><b>15:30 - 16:00</b></td></tr>
    <tr><td><b>16:00 - 16:30</b></td></tr>
    <tr>
      <td><b>16:30 - 17:00</b></td>
      <td rowspan="2" class="leisure">ğŸ® <b>LAZER (LoL)</b> / Livre</td>
      <td rowspan="2" class="family">ğŸ‘¨â€ğŸ‘©â€ğŸ‘§ Tempo Livre / FamÃ­lia</td>
    </tr>
    <tr><td><b>17:00 - 17:30</b></td></tr>
    <tr>
      <td><b>17:30 - 18:00</b></td>
      <td rowspan="2" class="personal">ğŸš— Deslocamento p/ Casa</td>
      <td rowspan="2" class="family">ğŸ‘¨â€ğŸ‘©â€ğŸ‘§ Tempo Livre / FamÃ­lia</td>
      <td rowspan="2" class="personal">ğŸš— Deslocamento p/ Casa</td>
      <td rowspan="2" class="family">ğŸ‘¨â€ğŸ‘©â€ğŸ‘§ Tempo Livre / FamÃ­lia</td>
      <td rowspan="2" class="family">ğŸ‘¨â€ğŸ‘©â€ğŸ‘§ Tempo Livre / FamÃ­lia</td>
      <td rowspan="7" class="family">ğŸ‘¨â€ğŸ‘©â€ğŸ‘§ Tempo Livre / FamÃ­lia</td>
      <td rowspan="7" class="family">ğŸ‘¨â€ğŸ‘©â€ğŸ‘§ Tempo Livre / FamÃ­lia</td>
    </tr>
    <tr><td><b>18:00 - 18:30</b></td></tr>
    <tr>
      <td><b>18:30 - 19:00</b></td>
      <td rowspan="5" class="family">ğŸ‘¨â€ğŸ‘©â€ğŸ‘§ Jantar / FamÃ­lia</td>
      <td rowspan="5" class="family">ğŸ‘¨â€ğŸ‘©â€ğŸ‘§ Jantar / FamÃ­lia</td>
      <td rowspan="5" class="family">ğŸ‘¨â€ğŸ‘©â€ğŸ‘§ Jantar / FamÃ­lia</td>
      <td rowspan="5" class="family">ğŸ‘¨â€ğŸ‘©â€ğŸ‘§ Jantar / FamÃ­lia</td>
      <td rowspan="5" class="family">ğŸ‘¨â€ğŸ‘©â€ğŸ‘§ Jantar / FamÃ­lia</td>
    </tr>
    <tr><td><b>19:00 - 19:30</b></td></tr>
    <tr><td><b>19:30 - 20:00</b></td></tr>
    <tr><td><b>20:00 - 20:30</b></td></tr>
    <tr><td><b>20:30 - 21:00</b></td></tr>
    <tr>
      <td><b>21:00 - 21:30</b></td>
      <td class="personal">âœ¨ Organizar Cozinha</td>
      <td class="personal">âœ¨ Organizar Cozinha</td>
      <td class="personal">âœ¨ Organizar Cozinha</td>
      <td class="personal">âœ¨ Organizar Cozinha</td>
      <td class="personal">âœ¨ Organizar Cozinha</td>
      <td class="personal">âœ¨ Organizar Cozinha</td>
      <td class="personal">âœ¨ Organizar Cozinha</td>
    </tr>
    <tr>
      <td><b>21:30 - 22:00</b></td>
      <td rowspan="2" class="leisure">ğŸ® <b>LAZER (LoL)</b> / Esposa</td>
      <td rowspan="2" class="family">ğŸŒ™ Tempo Livre / Esposa</td>
      <td rowspan="2" class="leisure">ğŸ® <b>LAZER (LoL)</b> / Esposa</td>
      <td rowspan="2" class="family">ğŸŒ™ Tempo Livre / Esposa</td>
      <td rowspan="2" class="leisure">ğŸ‰ Sextou! Livre</td>
      <td rowspan="2" class="leisure">ğŸŒ™ Tempo Livre / Filme</td>
      <td rowspan="2" class="family">ğŸŒ™ Tempo Livre / Esposa</td>
    </tr>
    <tr><td><b>22:00 - 22:30</b></td></tr>
    <tr>
      <td><b>22:30 - 23:00</b></td>
      <td class="personal">ğŸ“– Desacelerar / Leitura</td>
      <td class="personal">ğŸ“– Desacelerar / Leitura</td>
      <td class="personal">ğŸ“– Desacelerar / Leitura</td>
      <td class="personal">ğŸ“– Desacelerar / Leitura</td>
      <td class="personal">ğŸ“– Desacelerar / Leitura</td>
      <td class="personal">ğŸ“– Desacelerar / Leitura</td>
      <td class="personal">ğŸ“– Desacelerar / Leitura</td>
    </tr>
    <tr>
      <td><b>23:00</b></td>
      <td class="personal">ğŸ˜´ Dormir</td>
      <td class="personal">ğŸ˜´ Dormir</td>
      <td class="personal">ğŸ˜´ Dormir</td>
      <td class="personal">ğŸ˜´ Dormir</td>
      <td class="personal">ğŸ˜´ Dormir</td>
      <td class="personal">ğŸ˜´ Dormir</td>
      <td class="personal">ğŸ˜´ Dormir</td>
    </tr>
  </tbody>
</table>

<script>
  // Esta funÃ§Ã£o serÃ¡ executada assim que a pÃ¡gina for carregada
  window.onload = function() {
    // Pega a data e hora atuais
    const now = new Date();
    const currentDay = now.getDay(); // 0=Domingo, 1=Segunda, ..., 6=SÃ¡bado
    const currentHours = now.getHours();
    const currentMinutes = now.getMinutes();

    // Mapeia o dia da semana (retornado pelo JS) para o Ã­ndice da coluna da nossa tabela
    // Colunas: 0=HorÃ¡rio, 1=Segunda, 2=TerÃ§a, ..., 7=Domingo
    const dayToColumnIndex = [7, 1, 2, 3, 4, 5, 6];
    const highlightColumnIndex = dayToColumnIndex[currentDay];

    // Pega a tabela e todas as suas linhas do corpo
    const table = document.getElementById('schedule-table');
    const tableBodyRows = table.tBodies[0].rows;

    // // --- 1. Destaca a Coluna do Dia Atual ---
    // if (highlightColumnIndex > 0) { // Garante que nÃ£o vai tentar destacar a coluna de horÃ¡rio
    //   for (let i = 0; i < tableBodyRows.length; i++) {
    //     // Cuidado com as cÃ©lulas mescladas (rowspan)
    //     // Esta Ã© uma forma simples de contornar, pode nÃ£o pegar todas as cÃ©lulas mescladas, mas funciona visualmente
    //     let cellToHighlight = tableBodyRows[i].querySelector(`td:nth-of-type(${highlightColumnIndex})`);
    //     if(cellToHighlight) {
    //         cellToHighlight.classList.add('highlight-day');
    //     }
    //   }
    //   // Destaca tambÃ©m o cabeÃ§alho da coluna
    //   table.tHead.rows[0].cells[highlightColumnIndex].classList.add('highlight-day');
    // }

    // --- 2. Encontra e Destaca a Linha da Hora Atual ---
    let highlightRowIndex = -1;
    for (let i = 0; i < tableBodyRows.length; i++) {
      const timeCell = tableBodyRows[i].cells[0];
      const timeText = timeCell.innerText;
      // Pega a hora de inÃ­cio da linha (ex: "09:00")
      const timeMatch = timeText.match(/(\d{2}):(\d{2})/);

      if (timeMatch) {
        const rowHours = parseInt(timeMatch[1]);
        const rowMinutes = parseInt(timeMatch[2]);

        // Compara se a hora atual Ã© maior ou igual Ã  hora da linha.
        // A Ãºltima linha que satisfizer isso Ã© a linha atual.
        if (currentHours > rowHours || (currentHours === rowHours && currentMinutes >= rowMinutes)) {
          highlightRowIndex = i;
        }
      }
    }

    // Aplica o destaque na linha encontrada
    if (highlightRowIndex !== -1) {
      tableBodyRows[highlightRowIndex].classList.add('highlight-time');
    }

    // // --- 3. Destaca a CÃ©lula de InterseÃ§Ã£o ---
    // if (highlightRowIndex !== -1 && highlightColumnIndex > 0) {
    //   // Re-seleciona a cÃ©lula especÃ­fica para garantir que a classe de interseÃ§Ã£o seja aplicada
    //    let cellToHighlight = tableBodyRows[highlightRowIndex].querySelector(`td:nth-of-type(${highlightColumnIndex})`);
    //     if(cellToHighlight) {
    //         cellToHighlight.classList.add('highlight-intersect');
    //     }
    // }

    // --- 4. Mostra o dia da semana no texto ---
    const dayNames = ["Domingo", "Segunda-feira", "TerÃ§a-feira", "Quarta-feira", "Quinta-feira", "Sexta-feira", "SÃ¡bado"];
    document.getElementById('current-day-text').textContent = dayNames[currentDay];
  };
</script>

</body>
</html>

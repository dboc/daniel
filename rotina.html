<!DOCTYPE html>
<html lang="pt-br">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Minha Rotina Semanal Dinâmica e Responsiva</title>
<style>
  html, body {
    height: 100%; /* Garante que o corpo ocupe toda a altura */
    margin: 0;
    padding: 0;
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
    background-color: #f0f2f5;
  }
  body {
    display: flex;
    flex-direction: column;
    align-items: center; /* Centraliza o container */
    padding: 10px;
    box-sizing: border-box;
  }
  .container {
    width: 100%;
    max-width: 1600px; /* Limite máximo para telas grandes */
    flex-grow: 1; /* Faz o container crescer para ocupar o espaço */
    display: flex;
    flex-direction: column;
    background: #fff;
    border-radius: 8px;
    box-shadow: 0 4px 15px rgba(0,0,0,0.1);
    overflow: hidden; /* Esconde o excesso */
  }
  .header-info {
      padding: 15px 20px;
      text-align: center;
      border-bottom: 1px solid #eee;
  }
  .table-wrapper {
      overflow: auto; /* Permite rolagem vertical e horizontal na tabela */
      flex-grow: 1;
  }
  table {
    border-collapse: collapse;
    width: 100%;
    /* O tamanho da fonte agora se ajusta à tela */
    font-size: 1.5vmin;
  }
  th, td {
    border: 1px solid #e0e0e0;
    padding: 0.8em;
    text-align: center;
    vertical-align: middle;
    transition: background-color 0.3s;
  }
  th {
    background-color: #f8f9fa;
    position: sticky;
    top: 0; /* Faz o cabeçalho fixar ao rolar */
    z-index: 10;
  }
  td[rowspan] {
      vertical-align: middle;
  }
  .study { background-color: #e0f7fa; }
  .work { background-color: #fff9c4; }
  .exercise { background-color: #dcedc8; }
  .family { background-color: #ffe0b2; }
  .leisure { background-color: #f3e5f5; }
  .personal { background-color: #e0e0e0; }

  .highlight-day { background-color: #dbeafe !important; }
  .highlight-time { background-color: #dcfce7 !important; }
  .highlight-intersect {
    background-color: #93c5fd !important;
    font-weight: bold;
    color: black;
  }
</style>
</head>
<body>

<div class="container">
  <div class="header-info">
    <h2>Planilha de Rotina Dinâmica</h2>
    <p>Hoje é <strong><span id="current-day-text"></span></strong>. A rotina está destacando o dia e horário atuais.</p>
  </div>
  <div class="table-wrapper">
    <table id="schedule-table">
      <thead>
        <tr>
          <th>Horário</th>
          <th>Segunda-feira</th>
          <th>Terça-feira</th>
          <th>Quarta-feira</th>
          <th>Quinta-feira</th>
          <th>Sexta-feira</th>
          <th>Sábado</th>
          <th>Domingo</th>
        </tr>
      </thead>
      <tbody>
    <tr>
      <td><b>05:30 - 06:00</b></td>
      <td class="personal">💧 Despertar & Higiene</td>
      <td class="personal">💧 Despertar & Higiene</td>
      <td class="personal">💧 Despertar & Higiene</td>
      <td class="personal">💧 Despertar & Higiene</td>
      <td class="personal">💧 Despertar & Higiene</td>
      <td class="personal">💧 Despertar & Higiene</td>
      <td class="personal">💧 Despertar & Higiene</td>
    </tr>
    <tr>
      <td><b>06:00 - 06:30</b></td>
      <td rowspan="3" class="study">📚 <b>ESTUDO</b> (1.5h)</td>
      <td rowspan="3" class="study">📚 <b>ESTUDO</b> (1.5h)</td>
      <td rowspan="3" class="study">📚 <b>ESTUDO</b> (1.5h)</td>
      <td rowspan="3" class="study">📚 <b>ESTUDO</b> (1.5h)</td>
      <td rowspan="3" class="study">📚 <b>ESTUDO</b> (1.5h)</td>
      <td rowspan="4" class="study">📚 <b>ESTUDO</b> (2h)</td>
      <td rowspan="4" class="study">📚 <b>ESTUDO</b> (2h)</td>
    </tr>
    <tr>
      <td><b>06:30 - 07:00</b></td>
    </tr>
    <tr>
      <td><b>07:00 - 07:30</b></td>
    </tr>
    <tr>
      <td><b>07:30 - 08:00</b></td>
      <td class="family">👨‍👧 Rotina Manhã + 🚗 Deslocamento</td>
      <td class="family">👨‍👧 Rotina Manhã (Café)</td>
      <td class="family">👨‍👧 Rotina Manhã + 🚗 Deslocamento</td>
      <td class="family">👨‍👧 Rotina Manhã (Café)</td>
      <td class="family">👨‍👧 Rotina Manhã (Café)</td>
    </tr>
    <tr>
      <td><b>08:00 - 08:30</b></td>
      <td rowspan="7" class="work">💼 <b>TRABALHO</b></td>
      <td rowspan="7" class="work">💼 <b>TRABALHO</b></td>
      <td rowspan="7" class="work">💼 <b>TRABALHO</b></td>
      <td rowspan="7" class="work">💼 <b>TRABALHO</b></td>
      <td rowspan="7" class="work">💼 <b>TRABALHO</b></td>
      <td rowspan="10" class="family">👨‍👩‍👧 Café da Manhã & Tempo Livre / Família</td>
      <td rowspan="10" class="family">👨‍👩‍👧 Café da Manhã & Tempo Livre / Família</td>
    </tr>
    <tr><td><b>08:30 - 09:00</b></td></tr>
    <tr><td><b>09:00 - 09:30</b></td></tr>
    <tr><td><b>09:30 - 10:00</b></td></tr>
    <tr><td><b>10:00 - 10:30</b></td></tr>
    <tr><td><b>10:30 - 11:00</b></td></tr>
    <tr><td><b>11:00 - 11:30</b></td></tr>
    <tr>
      <td><b>11:30 - 12:00</b></td>
      <td rowspan="3" class="personal">🍛 Almoço / Pausa</td>
      <td rowspan="2" class="exercise">💪 <b>EXERCÍCIO</b></td>
      <td rowspan="3" class="personal">🍛 Almoço / Pausa</td>
      <td rowspan="2" class="exercise">💪 <b>EXERCÍCIO</b></td>
      <td rowspan="2" class="exercise">💪 <b>EXERCÍCIO</b></td>
    </tr>
    <tr>
      <td><b>12:00 - 12:30</b></td>
    </tr>
    <tr>
      <td><b>12:30 - 13:00</b></td>
      <td class="exercise">🍛 Almoço Pós-Treino</td>
      <td class="exercise">🍛 Almoço Pós-Treino</td>
      <td class="exercise">🍛 Almoço Pós-Treino</td>
    </tr>
    <tr>
      <td><b>13:00 - 13:30</b></td>
      <td rowspan="9" class="work">💼 <b>TRABALHO</b></td>
      <td rowspan="9" class="work">💼 <b>TRABALHO</b></td>
      <td rowspan="9" class="work">💼 <b>TRABALHO</b></td>
      <td rowspan="9" class="work">💼 <b>TRABALHO</b></td>
      <td rowspan="9" class="work">💼 <b>TRABALHO</b></td>
      <td rowspan="7" class="family">👨‍👩‍👧 Tempo Livre / Família</td>
      <td rowspan="7" class="family">👨‍👩‍👧 Tempo Livre / Família</td>
    </tr>
    <tr><td><b>13:30 - 14:00</b></td></tr>
    <tr><td><b>14:00 - 14:30</b></td></tr>
    <tr>
      <td><b>14:30 - 15:00</b></td>
    </tr>
    <tr><td><b>15:00 - 15:30</b></td></tr>
    <tr><td><b>15:30 - 16:00</b></td></tr>
    <tr><td><b>16:00 - 16:30</b></td></tr>
    <tr>
      <td><b>16:30 - 17:00</b></td>
      <td rowspan="2" class="leisure">🎮 <b>LAZER (LoL)</b> / Livre</td>
      <td rowspan="2" class="family">👨‍👩‍👧 Tempo Livre / Família</td>
    </tr>
    <tr><td><b>17:00 - 17:30</b></td></tr>
    <tr>
      <td><b>17:30 - 18:00</b></td>
      <td rowspan="2" class="personal">🚗 Deslocamento p/ Casa</td>
      <td rowspan="2" class="family">👨‍👩‍👧 Tempo Livre / Família</td>
      <td rowspan="2" class="personal">🚗 Deslocamento p/ Casa</td>
      <td rowspan="2" class="family">👨‍👩‍👧 Tempo Livre / Família</td>
      <td rowspan="2" class="family">👨‍👩‍👧 Tempo Livre / Família</td>
      <td rowspan="7" class="family">👨‍👩‍👧 Tempo Livre / Família</td>
      <td rowspan="7" class="family">👨‍👩‍👧 Tempo Livre / Família</td>
    </tr>
    <tr><td><b>18:00 - 18:30</b></td></tr>
    <tr>
      <td><b>18:30 - 19:00</b></td>
      <td rowspan="5" class="family">👨‍👩‍👧 Jantar / Família</td>
      <td rowspan="5" class="family">👨‍👩‍👧 Jantar / Família</td>
      <td rowspan="5" class="family">👨‍👩‍👧 Jantar / Família</td>
      <td rowspan="5" class="family">👨‍👩‍👧 Jantar / Família</td>
      <td rowspan="5" class="family">👨‍👩‍👧 Jantar / Família</td>
    </tr>
    <tr><td><b>19:00 - 19:30</b></td></tr>
    <tr><td><b>19:30 - 20:00</b></td></tr>
    <tr><td><b>20:00 - 20:30</b></td></tr>
    <tr><td><b>20:30 - 21:00</b></td></tr>
    <tr>
      <td><b>21:00 - 21:30</b></td>
      <td class="personal">✨ Organizar Cozinha</td>
      <td class="personal">✨ Organizar Cozinha</td>
      <td class="personal">✨ Organizar Cozinha</td>
      <td class="personal">✨ Organizar Cozinha</td>
      <td class="personal">✨ Organizar Cozinha</td>
      <td class="personal">✨ Organizar Cozinha</td>
      <td class="personal">✨ Organizar Cozinha</td>
    </tr>
    <tr>
      <td><b>21:30 - 22:00</b></td>
      <td rowspan="2" class="leisure">🎮 <b>LAZER (LoL)</b> / Esposa</td>
      <td rowspan="2" class="family">🌙 Tempo Livre / Esposa</td>
      <td rowspan="2" class="leisure">🎮 <b>LAZER (LoL)</b> / Esposa</td>
      <td rowspan="2" class="family">🌙 Tempo Livre / Esposa</td>
      <td rowspan="2" class="leisure">🎉 Sextou! Livre</td>
      <td rowspan="2" class="leisure">🌙 Tempo Livre / Filme</td>
      <td rowspan="2" class="family">🌙 Tempo Livre / Esposa</td>
    </tr>
    <tr><td><b>22:00 - 22:30</b></td></tr>
    <tr>
      <td><b>22:30 - 23:00</b></td>
      <td class="personal">📖 Desacelerar / Leitura</td>
      <td class="personal">📖 Desacelerar / Leitura</td>
      <td class="personal">📖 Desacelerar / Leitura</td>
      <td class="personal">📖 Desacelerar / Leitura</td>
      <td class="personal">📖 Desacelerar / Leitura</td>
      <td class="personal">📖 Desacelerar / Leitura</td>
      <td class="personal">📖 Desacelerar / Leitura</td>
    </tr>
    <tr>
      <td><b>23:00</b></td>
      <td class="personal">😴 Dormir</td>
      <td class="personal">😴 Dormir</td>
      <td class="personal">😴 Dormir</td>
      <td class="personal">😴 Dormir</td>
      <td class="personal">😴 Dormir</td>
      <td class="personal">😴 Dormir</td>
      <td class="personal">😴 Dormir</td>
    </tr>
      </tbody>
    </table>
    </div>
</div>

<script>
  function highlightCurrentTime() {
    const now = new Date();
    const currentDay = now.getDay(); // 0=Domingo, 1=Segunda, ...
    const currentHours = now.getHours();
    const currentMinutes = now.getMinutes();

    const dayToColumnIndex = [8, 2, 3, 4, 5, 6, 7]; // Ajustado para querySelector: 1=Horário, 2=Seg, ...
    const highlightColumnIndex = dayToColumnIndex[currentDay];

    const table = document.getElementById('schedule-table');
    const tableHeaderCells = table.tHead.rows[0].cells;
    const tableBodyRows = table.tBodies[0].rows;
    
    // Limpa destaques antigos
    document.querySelectorAll('.highlight-day, .highlight-time, .highlight-intersect').forEach(el => {
        el.classList.remove('highlight-day', 'highlight-time', 'highlight-intersect');
    });

    // 1. Destaca a Coluna do Dia
    if (highlightColumnIndex > 1) {
        tableHeaderCells[highlightColumnIndex - 1].classList.add('highlight-day');
        for (const row of tableBodyRows) {
            // Encontra a célula visível correta, considerando rowspans
            let cellIndex = highlightColumnIndex - 1;
            let currentCell = null;
            for(let i = 0; i < row.cells.length; i++){
                if(row.cells[i].cellIndex >= cellIndex){
                    currentCell = row.cells[i];
                    break;
                }
            }
            if(currentCell && currentCell.cellIndex === cellIndex){
                 currentCell.classList.add('highlight-day');
            }
        }
    }

    // 2. Destaca a Linha da Hora
    let highlightRow = null;
    for (let i = 0; i < tableBodyRows.length; i++) {
        const timeText = tableBodyRows[i].cells[0].innerText;
        const timeMatch = timeText.match(/(\d{2}):(\d{2})/);
        if (timeMatch) {
            const rowHours = parseInt(timeMatch[1]);
            const rowMinutes = parseInt(timeMatch[2]);
            if (currentHours > rowHours || (currentHours === rowHours && currentMinutes >= rowMinutes)) {
                highlightRow = tableBodyRows[i];
            } else {
                break; 
            }
        }
    }
    if (highlightRow) {
        highlightRow.classList.add('highlight-time');
    }

    // 3. Destaca a Célula de Interseção
    if (highlightRow && highlightColumnIndex > 1) {
        let cellIndex = highlightColumnIndex - 1;
        let intersectCell = null;
        for(let i = 0; i < highlightRow.cells.length; i++){
             if(highlightRow.cells[i].cellIndex >= cellIndex){
                intersectCell = highlightRow.cells[i];
                break;
            }
        }
        if(intersectCell && intersectCell.cellIndex === cellIndex){
            intersectCell.classList.add('highlight-intersect');
        }
    }
    
    // 4. Atualiza o texto do dia
    const dayNames = ["Domingo", "Segunda-feira", "Terça-feira", "Quarta-feira", "Quinta-feira", "Sexta-feira", "Sábado"];
    document.getElementById('current-day-text').textContent = dayNames[currentDay];
  }

  window.onload = function() {
    highlightCurrentTime();
    // Atualiza a cada 30 segundos
    setInterval(highlightCurrentTime, 30000); 
  };
</script>

</body>
</html>
